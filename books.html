<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Table - Brand</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=ABeeZee&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abel&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abhaya+Libre&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Aclonica&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:300,400,500">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway+Dots">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400&amp;display=swap">
    <link rel="stylesheet" href="assets/css/swiper-icons.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="assets/css/About-US.css">
    <link rel="stylesheet" href="assets/css/Account-setting-or-edit-profile.css">
    <link rel="stylesheet" href="assets/css/best-carousel-slide.css">
    <link rel="stylesheet" href="assets/css/card-3-column-animation-shadows-images.css">
    <link rel="stylesheet" href="assets/css/Contact-Us.css">
    <link rel="stylesheet" href="assets/css/dh-row-text-image-right-responsive.css">
    <link rel="stylesheet" href="assets/css/dh-row-titile-text-image-right-1.css">
    <link rel="stylesheet" href="assets/css/Features-Image-images.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/css/theme.bootstrap_4.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css">
    <link rel="stylesheet" href="assets/css/Latest-Blog.css">
    <link rel="stylesheet" href="assets/css/Login-Form-Basic-icons.css">
    <link rel="stylesheet" href="assets/css/login-form-styles.css">
    <link rel="stylesheet" href="assets/css/login-form.css">
    <link rel="stylesheet" href="assets/css/Ludens---1-Index-Table-with-Search--Sort-Filters-v20.css">
    <link rel="stylesheet" href="assets/css/Ludens-Users---2-Register.css">
    <link rel="stylesheet" href="assets/css/Pretty-Registration-Form-.css">
    <link rel="stylesheet" href="assets/css/Pretty-Search-Form-.css">
    <link rel="stylesheet" href="assets/css/Pretty-Table-tables.css">
    <link rel="stylesheet" href="assets/css/Pretty-Table.css">
    <link rel="stylesheet" href="assets/css/Profile-Edit-Form-styles.css">
    <link rel="stylesheet" href="assets/css/Profile-Edit-Form.css">
    <link rel="stylesheet" href="assets/css/Register-form.css">
    <link rel="stylesheet" href="assets/css/Search-Input-Responsive-with-Icon.css">
    <link rel="stylesheet" href="assets/css/Search-Input-responsive.css">
    <link rel="stylesheet" href="assets/css/Sign-Up-Form---Gabriela-Carvalho.css">
    <link rel="stylesheet" href="assets/css/Swiper-Card-Blog.css">
    <link rel="stylesheet" href="assets/css/Table-With-Search-search-table.css">
    <link rel="stylesheet" href="assets/css/Table-With-Search.css">
    <link rel="stylesheet" href="assets/css/Tamplate-SB-Admin-on-BSS.css">
    <link rel="stylesheet" href="assets/css/User-Payment-Overview-Rows---Panel-Container.css">

    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.1/firebase-database.js"></script>

</head>

<body id="page-top">

    <div id="wrapper">
        <nav class="navbar align-items-start sidebar sidebar-dark accordion bg-gradient-primary p-0 navbar-dark"
            style="background: rgb(51,55,55);">
            <div class="container-fluid d-flex flex-column p-0"><a
                    class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0" href="#">
                    <div class="sidebar-brand-icon rotate-n-15"></div>
                    <div class="sidebar-brand-text mx-3"
                        style="font-style: italic;font-family: Nunito, sans-serif;font-weight: bold;"></div>
                </a>
                <h1
                    style="font-size: 22px;font-style: italic;font-weight: bold;font-family: Aclonica, sans-serif;color: rgb(11,139,131);margin-bottom: 25px;padding-bottom: 0px;padding-top: 0px;margin-top: -51px;border-color: rgb(1,120,106);">
                    LIBROSPHERE</h1>
                <h1></h1><a class="btn" role="button" href="books.html"
                    style="padding-top: 15px;padding-bottom: 17px;width: 136.344px;color: rgb(248,249,251);margin-right: 6px;margin-top: 1px;margin-left: -62px;">Books</a><a
                    class="btn" role="button" href="register.html"
                    style="margin-top: 0px;padding-bottom: 21px;color: rgb(249,249,251);margin-left: -65px;"
                    id="registerButton">Register</a>
                <a class="btn" role="button" href="login.html" id="loginButton"
                    style="margin-top: -10px;color: rgb(250,250,255);margin-left: -73px;">Login</a>
                <hr class="sidebar-divider my-0">



            </div>
        </nav>
        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content">
                <nav class="navbar navbar-expand bg-white shadow mb-4 topbar static-top navbar-light"
                    style="background: rgb(64,82,103);">
                    <div class="container-fluid"><button class="btn btn-link d-md-none rounded-circle me-3"
                            id="sidebarToggleTop" type="button"><i class="fas fa-bars"></i></button>
                        <div class="float-start float-md-end mt-5 mt-md-0 search-area"></div><i
                            class="fas fa-sign-out-alt"
                            style="font-size: 43px;padding-left: 0px;margin-right: 148px;padding-right: 359px;margin-left: 1240px;"></i>
                        <ul class="navbar-nav flex-nowrap ms-auto">
                            <li class="nav-item dropdown d-sm-none no-arrow"><a class="dropdown-toggle nav-link"
                                    aria-expanded="false" data-bs-toggle="dropdown" href="#"><i
                                        class="fas fa-search"></i></a>
                                <div class="dropdown-menu dropdown-menu-end p-3 animated--grow-in"
                                    aria-labelledby="searchDropdown">
                                    <form class="me-auto navbar-search w-100">
                                        <div class="input-group"><input class="bg-light form-control border-0 small"
                                                type="text" placeholder="Search for ...">
                                            <div class="input-group-append"><button class="btn btn-primary py-0"
                                                    type="button"><i class="fas fa-search"></i></button></div>
                                        </div>
                                    </form>
                                </div>
                            </li>
                            <li class="nav-item dropdown no-arrow mx-1">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link"
                                        aria-expanded="false" data-bs-toggle="dropdown" href="#"></a>
                                    <div class="dropdown-menu dropdown-menu-end dropdown-list animated--grow-in">
                                        <h6 class="dropdown-header">alerts center</h6><a
                                            class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="me-3">
                                                <div class="bg-primary icon-circle"><i
                                                        class="fas fa-file-alt text-white"></i></div>
                                            </div>
                                            <div><span class="small text-gray-500">December 12, 2019</span>
                                                <p>A new monthly report is ready to download!</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="me-3">
                                                <div class="bg-success icon-circle"><i
                                                        class="fas fa-donate text-white"></i></div>
                                            </div>
                                            <div><span class="small text-gray-500">December 7, 2019</span>
                                                <p>$290.29 has been deposited into your account!</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="me-3">
                                                <div class="bg-warning icon-circle"><i
                                                        class="fas fa-exclamation-triangle text-white"></i></div>
                                            </div>
                                            <div><span class="small text-gray-500">December 2, 2019</span>
                                                <p>Spending Alert: We've noticed unusually high spending for your
                                                    account.</p>
                                            </div>
                                        </a><a class="dropdown-item text-center small text-gray-500" href="#">Show All
                                            Alerts</a>
                                    </div>
                                </div>
                            </li>
                            <li class="nav-item dropdown no-arrow mx-1">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link"
                                        aria-expanded="false" data-bs-toggle="dropdown" href="#"></a>
                                    <div class="dropdown-menu dropdown-menu-end dropdown-list animated--grow-in">
                                        <h6 class="dropdown-header">alerts center</h6><a
                                            class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle"
                                                    src="assets/img/avatars/avatar4.jpeg">
                                                <div class="bg-success status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>Hi there! I am wondering if you can
                                                        help me with a problem I've been having.</span></div>
                                                <p class="small text-gray-500 mb-0">Emily Fowler - 58m</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle"
                                                    src="assets/img/avatars/avatar2.jpeg">
                                                <div class="status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>I have the photos that you ordered last
                                                        month!</span></div>
                                                <p class="small text-gray-500 mb-0">Jae Chun - 1d</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle"
                                                    src="assets/img/avatars/avatar3.jpeg">
                                                <div class="bg-warning status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>Last month's report looks great, I am
                                                        very happy with the progress so far, keep up the good
                                                        work!</span></div>
                                                <p class="small text-gray-500 mb-0">Morgan Alvarez - 2d</p>
                                            </div>
                                        </a><a class="dropdown-item d-flex align-items-center" href="#">
                                            <div class="dropdown-list-image me-3"><img class="rounded-circle"
                                                    src="assets/img/avatars/avatar5.jpeg">
                                                <div class="bg-success status-indicator"></div>
                                            </div>
                                            <div class="fw-bold">
                                                <div class="text-truncate"><span>Am I a good boy? The reason I ask is
                                                        because someone told me that people say this to all dogs, even
                                                        if they aren't good...</span></div>
                                                <p class="small text-gray-500 mb-0">Chicken the Dog · 2w</p>
                                            </div>
                                        </a><a class="dropdown-item text-center small text-gray-500" href="#">Show All
                                            Alerts</a>
                                    </div>
                                </div>
                                <div class="shadow dropdown-list dropdown-menu dropdown-menu-end"
                                    aria-labelledby="alertsDropdown"></div>
                            </li>
                            <div class="d-none d-sm-block topbar-divider"></div>
                            <li class="nav-item dropdown no-arrow">
                                <div class="nav-item dropdown no-arrow"><a class="dropdown-toggle nav-link"
                                        aria-expanded="false" data-bs-toggle="dropdown" href="my account.html"
                                        style="margin-left: -20px;padding-left: 94px;margin-right: -20px;"></a>
                                    <div class="dropdown-menu shadow dropdown-menu-end animated--grow-in"><a
                                            class="dropdown-item" href="#"><i
                                                class="fas fa-user fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Profile</a><a
                                            class="dropdown-item" href="#"><i
                                                class="fas fa-cogs fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Settings</a><a
                                            class="dropdown-item" href="#"><i
                                                class="fas fa-list fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Activity
                                            log</a>
                                        <div class="dropdown-divider"></div><a class="dropdown-item" href="#"><i
                                                class="fas fa-sign-out-alt fa-sm fa-fw me-2 text-gray-400"></i>&nbsp;Logout</a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
                <div class="container-fluid">
                    <div class="card shadow">
                        <div class="card-header py-3">
                            <p class="text-primary m-0 fw-bold" style="font-size: 26px;color: #1e9183;">Books</p>
                        </div>
                        <div class="card-body" id="card-body-container">
                            <div class="table-responsive table mt-2" id="dataTable" role="grid"
                                aria-describedby="dataTable_info">
                                <table class="table my-0" id="dataTable">
                                    <thead>
                                        <tr></tr>
                                    </thead>
                                    <tbody>
                                        <tr></tr>
                                    </tbody>
                                    <tfoot>
                                        <tr></tr>
                                    </tfoot>
                                </table>
                            </div>
                            <div class="card" id="bookCard">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <footer class="bg-white sticky-footer">
                <div class="container my-auto">
                    <div class="text-center my-auto copyright"><span>Copyright © Brand 2023</span></div>
                </div>
            </footer>
        </div><a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
    </div>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.6.0/umd/popper.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>
    <script src="assets/js/DataTable---Fully-BSS-Editable-style.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/jquery.tablesorter.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/widgets/widget-filter.min.js"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.2/js/widgets/widget-storage.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
    <script src="https://geodata.solutions/includes/countrystate.js"></script>
    <script
        src="assets/js/Ludens---1-Index-Table-with-Search--Sort-Filters-v20-Ludens---1-Index-Table-with-Search--Sort-Filters.js"></script>
    <script
        src="assets/js/Ludens---1-Index-Table-with-Search--Sort-Filters-v20-Ludens---Material-UI-Actions.js"></script>
    <script src="assets/js/Profile-Edit-Form-profile.js"></script>
    <script src="assets/js/Swiper-Card-Blog-swiper-bundle.min.js"></script>
    <script src="assets/js/Swiper-Card-Blog-swiper.js"></script>
    <script src="assets/js/Table-With-Search-search-table.js"></script>
    <script src="assets/js/theme.js"></script>


    <script>

        // Import the functions you need from the SDKs you need

        const firebaseConfig = {
            apiKey: "AIzaSyAOwGBvYe1w_vFFVOeF04Uhhot7-CX4Hk8",
            authDomain: "librosphere-9b371.firebaseapp.com",
            projectId: "librosphere-9b371",
            storageBucket: "librosphere-9b371.appspot.com",
            databaseURL: "librosphere-9b371-default-rtdb.firebaseio.com",
            messagingSenderId: "103165721536",
            appId: "1:103165721536:web:e02a086e341b6738152625",
            measurementId: "G-3SYC6MFZE7"
        };

        firebase.initializeApp(firebaseConfig);
        console.log("Error:  " + firebase.authDomain);


        // Reference to your Firebase Realtime Database
        var database = firebase.database();
        var booksRef = database.ref('books'); // Assuming you have a 'books' node in your database

        var idU = "";
        var loginBtn = document.getElementById("loginButton");
        var registerBtn = document.getElementById("registerButton");
        // Check the user's login status
        firebase.auth().onAuthStateChanged(function (user) {
            if (user) {
                // User is signed in, redirect to another page
                loginBtn.style.display = "none";
                registerBtn.style.display = "none";
                console.log("user: " + user.uid);

                idU = (user.uid).trim();


            } else {
                // User is not signed in
                loginBtn.style.display = "block";
                registerBtn.style.display = "block";
                console.log("No user is signed in");
            }
        });





        // Function to create a card element based on book data
        function createCard(bookData, count) {
            const card = document.createElement("div");
            card.className = "card";

            card.innerHTML = `
      <div class="row">
        <div class="col-md-5">
          <h4 style="font-size: 18.346px;font-weight: bold;">${bookData.name}</h4>
        </div>
        <div class="col">
          <h1 style="font-size: 19.73px;font-weight: bold;">${bookData.author}</h1>
        </div>
      </div>
      <div class="row">
        <div class="col-md-5">
          <picture><img src="${bookData.imageSrc}" style="width: 157px;height: 213.292px;" width="157" height="213"></picture>
          <div class="d-flex media">
            <div></div>
            <div class="media-body">
              <h4><a href="#" style="font-size: 30px;">${bookData.author}</a></h4>
            </div>
          </div>
        </div>
        <div class="col-md-4" style="padding-bottom: 20px;margin-bottom: -1px;">
          <p></p>
          <p style="color: rgb(40,34,34);">Serial number: ${bookData.serialNumber}</p>
          <p style="color: rgb(40,34,34);">Category: ${bookData.category}</p>
          <p style="color: rgb(8,7,7);">Author: ${bookData.author}<br>${bookData.description}<br><br></p>
          <p>Paragraph</p>
        </div>
        <div class="col-md-3 text-end">
          <div class="btn-group" role="group"><button class="btn btn-primary" type="button" name="borrow_button" value="${count}" onclick="onButtonBorrow()"><span style="font-weight: normal !important;">Borrow</span></button></div>
        </div>
      </div>
    `;

            return card;
        }

        var count = 0;
        var bookDataList2 = [];
        // Function to create a list of card elements based on an array of book data 
        function createCardList(bookDataList) {
            const cardListContainer = document.getElementById("card-body-container");

            bookDataList2 = bookDataList;

            for (const bookData of bookDataList) {
                const card = createCard(bookData, (count));
                cardListContainer.appendChild(card);

                count += 1;
                console.log(card);
            }


        }


        // Retrieve book data from Firebase Realtime Database
        booksRef.once('value')
            .then(function (snapshot) {
                const bookDataList = [];

                snapshot.forEach(function (childSnapshot) {
                    const bookData = childSnapshot.val();
                    bookDataList.push(bookData);
                    console.log('Data: ', bookData);
                });

                // Call the function to create the card list
                createCardList(bookDataList);
            })
            .catch(function (error) {
                console.error("Error retrieving book data:", error);
            });


        function onButtonBorrow() {

            var buttonBorrow = document.getElementsByName("borrow_button");


            for (const bt of buttonBorrow) {
                bt.addEventListener('click', function () {
                    // selectedValue = bt.value;
                    handleClicking(bt.value);
                })

            }


            function handleClicking(result) {

                // if (result == 1) {
                console.log(result);
                console.log("user is  " + idU);
                // alert("Works " + result);

                // for (const bookData of bookDataList) {
                //     var bookName = bookDataList2[result].name;
                // firebase.database().ref("issuedBooks/" + bookName).set({
                //     firstName: document.getElementById('inputFirstName').value,
                //     lastName: document.getElementById('inputLastName').value,
                //     email: document.getElementById("inputEmail").value
                // });


                database.ref("users").on('value', (snapshot) => {
                    snapshot.forEach((child) => {

                        if (child.key == idU) {
                            // console.log(child.key); // "child1", "child2"
                            // console.log(child.child("firstName").val()); // "123", "123"


                            // Get the current date
                            const currentDate = new Date();
                            // Increase the date by 5 days
                            const increasedDate = new Date(currentDate);
                            increasedDate.setDate(currentDate.getDate() + 5);
                            // Format the dates for display (DD-MM-YYYY)
                            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
                            const formattedIncreasedDate = increasedDate.toLocaleDateString('en-GB', options);
                            console.log(formattedIncreasedDate);


                            var userName = child.child("firstName").val() + " " + child.child("lastName").val();
                            var bookName = bookDataList2[result].name;
                            var serial = bookDataList2[result].serialNumber;
                                firebase.database().ref("issuedBooks/" + bookName).set({
                                    usreFullName: userName,
                                    userID: idU,
                                    bookName: bookName,
                                    serialNumber: serial,
                                    returnDate: formattedIncreasedDate,
                                    status: "N"
                                });
                        }

                    });
                });

                // }
                // }
            }
        }


    </script>

</body>

</html>